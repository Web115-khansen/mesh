"undefined"==typeof multiple_content_sections&&(multiple_content_sections={}),multiple_content_sections.admin=function(a){var b=a("body"),c=a(".mcs-section-reorder"),d=a(".mcs-section-add"),e=a(".mcs-section-expand"),f=a("#mcs-container"),g=a("#multiple-content-sections-container"),h=a("#mcs-description"),i=[],j={theme:"modern",skin:"lightgray",language:"en",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img,table,dl.wp-caption",classes:"alignleft"}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img,table,dl.wp-caption",classes:"aligncenter"}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"}},{selector:"img,table,dl.wp-caption",classes:"alignright"}],strikethrough:{inline:"del"}},relative_urls:!1,remove_script_host:!1,convert_urls:!1,browser_spellcheck:!0,fix_list_elements:!0,entities:"38,amp,60,lt,62,gt",entity_encoding:"raw",keep_styles:!1,cache_suffix:"wp-mce-4203-20150730",preview_styles:"font-family font-size font-weight font-style text-decoration text-transform",end_container_on_empty_block:!0,wpeditimage_disable_captions:!1,wpeditimage_html5_captions:!0,plugins:"charmap,colorpicker,hr,lists,media,paste,tabfocus,textcolor,fullscreen,wordpress,wpeditimage,wpemoji,wpgallery,wplink,wpdialogs,wptextpattern,wpview",content_css:mcs_data.site_uri+"/wp-includes/css/dashicons.css?ver=4.3,"+mcs_data.site_uri+"/wp-includes/js/tinymce/skins/wordpress/wp-content.css?ver=4.3,https://fonts.googleapis.com/css?family=Noto+Sans%3A400italic%2C700italic%2C400%2C700%7CNoto+Serif%3A400italic%2C700italic%2C400%2C700%7CInconsolata%3A400%2C700&subset=latin%2Clatin-ext,"+mcs_data.content_css,resize:!1,menubar:!1,wpautop:!0,indent:!1,toolbar1:"bold,italic,bullist,numlist,blockquote,hr,alignleft,aligncenter,alignright,link,unlink,spellchecker",toolbar2:"",toolbar3:"",toolbar4:"",tabfocus_elements:"content-html,save-post",body_class:"content post-type-page post-status-publish locale-en-us",wp_autoresize_on:!1,add_unload_trigger:!1};return{init:function(){b.on("click",".mcs-section-add",multiple_content_sections.admin.add_section).on("click",".mcs-section-remove",multiple_content_sections.admin.remove_section).on("click",".mcs-section-reorder",multiple_content_sections.admin.reorder_sections).on("click",".mcs-save-order",multiple_content_sections.admin.save_section_order).on("change",".mcs-choose-layout",multiple_content_sections.admin.choose_layout).on("click",".mcs-featured-image-choose",multiple_content_sections.admin.choose_background).on("click.OpenMediaManager",".mcs-featured-image-choose",multiple_content_sections.admin.choose_background).on("click",".mcs-featured-image-trash",multiple_content_sections.admin.remove_background).on("click",".mcs-section-expand",multiple_content_sections.admin.expand_all_sections).on("keyup",".mcs-section-title",multiple_content_sections.admin.change_section_title).on("click",".mcs-block-propagation",multiple_content_sections.admin.block_propagation).on("click",".mcs-block-featured-image-choose",multiple_content_sections.admin.choose_block_background).on("click.OpenMediaManager",".mcs-block-featured-image-choose",multiple_content_sections.admin.choose_block_background).on("click",".mcs-block-featured-image-trash",multiple_content_sections.admin.remove_block_background);var d=a(".multiple-content-sections-section");d.length<=1&&c.addClass("disabled"),multiple_content_sections.admin.setup_slider(),multiple_content_sections.admin.setup_drag_drop()},setup_notifications:function(b){b.find(".notice.is-dismissible").each(function(){var b=a(this),c=a('<button type="button" class="notice-dismiss"><span class="screen-reader-text"></span></button>'),d=commonL10n.dismiss||"";c.find(".screen-reader-text").text(d),b.append(c),c.on("click.wp-dismiss-notice",function(c){c.preventDefault(),b.fadeTo(100,0,function(){a(this).slideUp(100,function(){a(this).remove()})})})})},change_column_widths:function(b,c){var d=a(b.target),e=d.parent().parent().parent().find(".mcs-editor-blocks").find(".columns").addClass("dragging"),f=e.length,g=12,h=c.value,i=12,j=3,k=0,l=0,m=[];2==f?(i=9,j=3,h=Math.max(j,h),h=Math.min(i,h),m=[h,g-h]):3==f&&("undefined"!=typeof c.value&&(k=h&&2>f?h:c.values[0],l=c.values[1]),i=6,j=3,m=[],h=Math.max(j,k),h=Math.min(i,h),m[0]=h,j=k+3,i=9,h=Math.max(j,l),h=Math.min(i,h),m[1]=h-m[0],m[2]=g-(m[0]+m[1])),e.removeClass(function(a,b){return(b.match(/\mcs-columns-\d+/g)||[]).join(" ")}).each(function(b){a(this).addClass("mcs-columns-"+m[b])})},setup_slider:function(){a(".column-slider").addClass("ui-slider-horizontal").each(function(){var b=a(this),c=parseInt(b.attr("data-mcs-blocks")),d=c>2?!0:!1,e=a.parseJSON(b.attr("data-mcs-columns")),f={value:e[0],range:d,min:0,max:12,step:1,start:function(){b.css("z-index",1e3)},stop:function(){b.css("z-index","").find(".ui-slider-handle").css("z-index",1e3)},change:multiple_content_sections.admin.save_column_widths,slide:multiple_content_sections.admin.change_column_widths};3===c&&(e[1]=e[0]+e[1],e.pop(),f.values=e,f.value=null),b.slider(f)})},setup_drag_drop:function(){a(".mcs-editor-blocks .block").draggable({appendTo:"body",helper:"original",revert:!0,handle:".mcs-row-title"}),a(".block").addClass("ui-widget ui-widget-content ui-helper-clearfix").find(".block-header").addClass("hndle ui-sortable-handle").prepend("<span class='block-toggle'></span>"),a(".drop-target").droppable({accept:".block:not(.ui-sortable-helper)",activeClass:"ui-state-hover",hoverClass:"ui-state-active",handle:".block-header",revert:!0,drop:function(b,c){var d=a(this),e=c.draggable,f=c.draggable.parent(),g=a(b.target),h=g.find(".block"),i=g.parents(".multiple-content-sections-section"),j=i.attr("data-mcs-section-id");return e.css({top:"",left:""}),d.append(e),f.append(h),multiple_content_sections.admin.reorder_blocks(i.find(".wp-editor-area")),multiple_content_sections.admin.save_block_order_sortable(j,b,c),multiple_content_sections.admin.setup_drag_drop(),!1}})},reorder_blocks:function(b){b.each(function(){var b=a(this).prop("id"),c=j;"undefined"!=typeof tinymce.editors&&tinymce.editors[b]&&tinymce.get(b).remove(),c.selector="#"+b,tinymce.init(c)})},expand_all_sections:function(b){b.preventDefault(),b.stopPropagation();var c=a(this);c.toggleClass("expanded"),c.hasClass("expanded")?c.text("Collapse All"):c.text("Expand All"),a("#multiple-content-sections-container").find(".hndle").trigger("click")},choose_layout:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.siblings(".spinner"),e=c.parents(".multiple-content-sections-section"),f=e.attr("data-mcs-section-id");return c.hasClass("disabled")?!1:(d.addClass("is-active"),void a.post(ajaxurl,{action:"mcs_choose_layout",mcs_post_id:mcs_data.post_id,mcs_section_id:f,mcs_section_layout:a(this).val(),mcs_choose_layout_nonce:mcs_data.choose_layout_nonce},function(b){if(b){var c=a(b),e=c.find(".wp-editor-area"),g=a("#mcs-sections-editor-"+f);g.html("").append(c),multiple_content_sections.admin.reorder_blocks(e),multiple_content_sections.admin.setup_slider(),multiple_content_sections.admin.setup_drag_drop(),multiple_content_sections.admin.setup_notifications(g),d.removeClass("is-active")}else d.removeClass("is-active")}))},add_section:function(b){b.preventDefault(),b.stopPropagation();var d=a(this),e=d.siblings(".spinner");return d.hasClass("disabled")?!1:(e.addClass("is-active"),void a.post(ajaxurl,{action:"mcs_add_section",mcs_post_id:mcs_data.post_id,mcs_add_section_nonce:mcs_data.add_section_nonce},function(b){if(b){var d=a(b),h=d.find(".wp-editor-area");g.append(d),e.removeClass("is-active");var i=a(".multiple-content-sections-section",f);i.length>1&&c.removeClass("disabled"),multiple_content_sections.admin.reorder_blocks(h)}else e.removeClass("is-active")}))},remove_section:function(b){b.preventDefault(),b.stopPropagation();var d=a(this),e=d.parents(".multiple-content-sections-postbox"),g=a(".mcs-add-spinner",e),h=e.attr("data-mcs-section-id");g.addClass("is-active"),a.post(ajaxurl,{action:"mcs_remove_section",mcs_post_id:mcs_data.post_id,mcs_section_id:h,mcs_remove_section_nonce:mcs_data.remove_section_nonce},function(b){"1"===b?e.fadeOut(400,function(){e.remove(),$postboxes=a(".multiple-content-sections-section",f),$postboxes.length<=1&&c.addClass("disabled")}):g.removeClass("is-active")})},save_column_widths:function(b,c){var d=a(b.target),e=d.parent().parent().parent().find(".mcs-editor-blocks").find(".columns"),f=e.length,g=12,h=d.slider("value"),i={post_id:parseInt(mcs_data.post_id),section_id:parseInt(d.closest(".multiple-content-sections-section").attr("data-mcs-section-id")),blocks:{}},j=12,k=3,l=h&&2>f?h:d.slider("values",0),m=d.slider("values",1),n=[];return 2==f&&(j=9,k=3,h=Math.max(k,h),h=Math.min(j,h),h!=d.slider("value")&&d.slider("value",h),n=[h,g-h]),3==f&&(j=6,k=3,n=[],h=Math.max(k,l),h=Math.min(j,h),n[0]=h,k=l+3,j=9,h=Math.max(k,m),h=Math.min(j,h),n[1]=h-n[0],n[2]=g-(n[0]+n[1]),n[0]!=d.slider("option","values")[0]||h!=d.slider("option","values")[1])?void d.slider("option","values",[h[0],h]).refresh():(e.removeClass(function(a,b){return(b.match(/\mcs-columns-\d+/g)||[]).join(" ")}),e.each(function(b){var c=a(this),d=parseInt(c.find(".block").attr("data-mcs-block-id")),e=c.find(".column-width");c.addClass("mcs-columns-"+n[b]),d&&n[b]&&(e.val(n[b]),i.blocks[d.toString()]=n[b])}),void a.post(ajaxurl,{action:"mcs_update_block_widths",mcs_post_data:i,mcs_reorder_blocks_nonce:mcs_data.reorder_blocks_nonce},function(a){}))},reorder_sections:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),h=(c.siblings(".spinner"),a(".multiple-content-sections-postbox",g)),i=a("<span />",{"class":"mcs-block-click"});e.addClass("disabled"),d.addClass("disabled"),f.addClass("mcs-is-ordering"),multiple_content_sections.admin.update_notifications("reorder","warning"),a(".hndle",f).each(function(){a(this).prepend(i.clone())}),a(".mcs-block-click").on("click",multiple_content_sections.admin.block_click),c.text("Save Order").addClass("mcs-save-order button-primary").removeClass("mcs-section-reorder"),h.each(function(){a(this).addClass("closed")}),g.sortable({update:multiple_content_sections.admin.save_section_order_sortable})},update_notifications:function(a,b){h.removeClass("notice-info notice-warning notice-success").addClass("notice-"+b).find("p").text(mcs_data.labels[a]),h.is(":visible")||h.css({opacity:0}).show(),h.fadeIn("fast")},save_block_order_sortable:function(b,c,d){var e=a(".mcs-reorder-spinner"),f=[];a("#mcs-sections-editor-"+b).find(".block").each(function(){f.push(a(this).attr("data-mcs-block-id"))}),response=multiple_content_sections.admin.save_block_ajax(b,f,e)},save_block_ajax:function(b,c,d){a.post(ajaxurl,{action:"mcs_update_block_order",mcs_section_id:b,mcs_blocks_ids:c,mcs_reorder_blocks_nonce:mcs_data.reorder_blocks_nonce},function(a){})},save_section_order_sortable:function(b,c){var d=a(".mcs-reorder-spinner"),e=[];d.addClass("is-active"),a(".multiple-content-sections-postbox",g).each(function(){e.push(a(this).attr("data-mcs-section-id"))}),response=multiple_content_sections.admin.save_section_ajax(e,d)},save_section_order:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),f=(a(".multiple-content-sections-postbox",g),a(".mcs-reorder-spinner")),i=[];f.addClass("is-active"),e.removeClass("disabled"),d.removeClass("disabled"),c.text("Reorder").addClass("mcs-section-reorder").removeClass("mcs-save-order button-primary"),a(".multiple-content-sections-postbox",g).each(function(){i.push(a(this).attr("data-mcs-section-id"))}),a(".mcs-block-click").remove(),h.is(":visible")&&h.removeClass("notice-warning").addClass("notice-info").find("p").text(mcs_data.labels.description),multiple_content_sections.admin.save_section_ajax(i,f),g.sortable("destroy")},save_section_ajax:function(b,c){a.post(ajaxurl,{action:"mcs_update_order",mcs_post_id:parseInt(mcs_data.post_id),mcs_section_ids:b,mcs_reorder_section_nonce:mcs_data.reorder_section_nonce},function(a){c.removeClass("is-active")})},change_section_title:function(b){var c=a(this),d=c.val(),e=c.parents(".multiple-content-sections-postbox");(""===d||"undefined"==d)&&(d="No Title"),e.find(".handle-title").text(d)},block_click:function(a){a.stopImmediatePropagation()},block_propagation:function(a){a.stopImmediatePropagation(),a.preventDefault(),a.stopPropagation()},remove_background:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.parents(".multiple-content-sections-postbox"),e=parseInt(d.attr("data-mcs-section-id")),f=(c.attr("data-mcs-section-featured-image"),a("<span />").attr({"class":"dashicons dashicons-format-image"}));a.post(ajaxurl,{action:"mcs_update_featured_image",mcs_section_id:parseInt(e),mcs_featured_image_nonce:mcs_data.featured_image_nonce},function(a){-1!=a&&(c.prev().text(mcs_data.labels.add_image).prepend(f),c.remove())})},choose_background:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.parents(".multiple-content-sections-postbox"),e=parseInt(d.attr("data-mcs-section-id")),f="mcs-background-select-"+e,g=c.attr("data-mcs-section-featured-image");return i[f]?(i[f].uploader.uploader.param("mcs_upload","true"),void i[f].open()):(i[f]=wp.media.frames.media_frames=wp.media({className:"media-frame mcs-media-frame",frame:"select",multiple:!1,title:"Select Section Background",button:{text:"Select Background"}}),i[f].on("open",function(){var a=i[f].state().get("selection");a.add(wp.media.attachment(g))}),i[f].on("select",function(){var b=i[f].state().get("selection").first().toJSON(),d=a("<span />",{"class":"dashicons dashicons-edit"}),h=a("<span />",{"class":"dashicons dashicons-trash"}),j=a("<a/>",{"data-mcs-section-featured-image":"",href:"#","class":"mcs-featured-image-trash"}).text(mcs_data.labels.remove_image).prepend(h);a.post(ajaxurl,{action:"mcs_update_featured_image",mcs_section_id:parseInt(e),mcs_image_id:parseInt(b.id),mcs_featured_image_nonce:mcs_data.featured_image_nonce},function(a){-1!=a&&(g=b.id,c.text(b.title).attr("data-mcs-section-featured-image",parseInt(b.id)).append(d).after(j))})}),void i[f].open())},choose_block_background:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.parents(".block"),e=parseInt(d.attr("data-mcs-block-id")),f="mcs-background-select-"+e,g=c.attr("data-mcs-block-featured-image");return i[f]?(i[f].uploader.uploader.param("mcs_upload","true"),void i[f].open()):(i[f]=wp.media.frames.media_frames=wp.media({className:"media-frame mcs-media-frame",frame:"select",multiple:!1,title:"Select Block Background",button:{text:"Select Block Background"}}),i[f].on("open",function(){var a=i[f].state().get("selection");a.add(wp.media.attachment(g))}),i[f].on("select",function(){var b=i[f].state().get("selection").first().toJSON(),d=a("<span />",{"class":"dashicons dashicons-edit"}),h=a("<span />",{"class":"dashicons dashicons-trash"}),j=a("<button/>",{type:"button","data-mcs-section-featured-image":"",href:"#","class":"mcs-featured-image-trash"}).text(mcs_data.labels.remove_image).prepend(h);a.post(ajaxurl,{action:"mcs_update_featured_image",mcs_section_id:parseInt(e),mcs_image_id:parseInt(b.id),mcs_featured_image_nonce:mcs_data.featured_image_nonce},function(a){-1!=a&&(g=b.id,c.text(b.title).attr("data-mcs-section-featured-image",parseInt(b.id)).append(d).after(j))})}),void i[f].open())},remove_block_background:function(b){b.preventDefault(),b.stopPropagation();var c=a(this),d=c.parents(".block"),e=parseInt(d.attr("data-mcs-block-id")),f=(c.attr("data-mcs-block-featured-image"),a("<span />").attr({"class":"dashicons dashicons-format-image"}));a.post(ajaxurl,{action:"mcs_update_featured_image",mcs_section_id:parseInt(e),mcs_featured_image_nonce:mcs_data.featured_image_nonce},function(a){-1!=a&&(c.prev().text(mcs_data.labels.add_image).prepend(f),c.remove())})}}}(jQuery),jQuery(function(a){multiple_content_sections.admin.init()});